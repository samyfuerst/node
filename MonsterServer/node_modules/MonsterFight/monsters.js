//EXECUTION
var Godzilla=require('./lib/Godzilla');
var KingKong=require('./lib/KingKong');


var Ref=require('monsters');

var colors=require('ansicolors');


function Fight(){
    var _godzilla = new Godzilla.Godzilla(["Punch", "Tackle", "BattleCry", "RoundHouseKick"]);
    var _kingKong = new KingKong.KingKong(["Stamp", "Punch", "Tackle", "DrumOnChest"]);
    
    this.monsters=[_godzilla,_kingKong];
        
    
	this.referee = new Ref.Referee();
    
    this.letsFight=function(){
        this.referee.greetMonsters(_kingKong, _godzilla);
        this.referee.checkForCheaters();
        this.referee.startFight();
    }
    
    var onAttack=function(n,ap){
        console.log(colors.brightRed('%s attacks %s with %s'),this.name,n,ap);
    };
    
    var onHit=function(ap){
        console.log(colors.brightCyan('%s was hit and lost %s health points; %s hp left'),this.name,ap,this._health);
    };
    
    var onDefend=function(){
        console.log(colors.brightGreen('%s averted an attack'),this.name);
    };
    
    var onDie=function(){
        console.log(colors.brightBlack('%s unfortunately died'),this.name);
    };
    
    var onGrowl=function(sound){
        console.log(colors.brightBlue('%s says: %s'),this.name,sound);
    };
    
    
    for (m in this.monsters){
        this.monsters[m].addListener('attack',onAttack);
        this.monsters[m].addListener('hit',onHit);
        this.monsters[m].addListener('defend',onDefend);
        this.monsters[m].addListener('die',onDie);
        this.monsters[m].addListener('growl',onGrowl);
    };
    
}


module.exports=Fight;
